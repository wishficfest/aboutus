progress.html

<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Author Progress ‚Äî Motivation Wall</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <style>
    :root{
      --bg:#f3e7d4; --ink:#1f1f1f; --muted:#6b5e4f; --card:#fff; --accent:#215c43;
      --note-yellow:#fff6a6; --note-pink:#ffd7e3; --note-blue:#d7f3ff; --note-green:#e7ffd8;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);
         font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial}
    .wrap{max-width:1100px;margin:auto;padding:20px}
    .toolbar{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px}
    .btn{appearance:none;border:0;border-radius:12px;padding:10px 14px;font-weight:800;
         background:#fff;box-shadow:0 8px 22px rgba(0,0,0,.08);cursor:pointer}
    .btn.dark{background:var(--accent);color:#fff}
    .btn.small{padding:7px 10px;border-radius:10px;font-weight:700}
    h1{margin:4px 0 0;font-size:clamp(24px,4.8vw,40px);text-align:center}
    .sub{color:var(--muted);text-align:center;margin:4px 0 18px}
    /* layout */
    .row{display:grid;grid-template-columns:320px 1fr;gap:18px;align-items:start}
    @media (max-width:820px){ .row{grid-template-columns:1fr;gap:14px} }
    .panel{background:var(--card);border-radius:16px;padding:16px;
           box-shadow:0 12px 26px rgba(0,0,0,.08)}
    .form input,.form textarea{width:100%;padding:12px;border:1px solid #e5ddcf;border-radius:12px}
    .form textarea{min-height:120px;resize:vertical}
    .form .actions{display:flex;gap:10px;margin-top:10px}
    /* board: GRID supaya tidak numpuk */
    .board{min-height:480px;background:#fff;border-radius:16px;padding:16px;
           box-shadow:0 12px 26px rgba(0,0,0,.08);
           display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
           gap:14px; align-content:start}
    @media (max-width:820px){ .board{min-height:360px} }
    /* note card */
    .note{position:relative;padding:12px 12px 26px;border-radius:12px;
          box-shadow:0 8px 18px rgba(0,0,0,.12);white-space:pre-wrap;word-break:break-word}
    .note.yellow{background:var(--note-yellow)}
    .note.pink{background:var(--note-pink)}
    .note.blue{background:var(--note-blue)}
    .note.green{background:var(--note-green)}
    .note small{display:block;margin-top:6px;color:#3b3b3b;opacity:.8}
    .note .x{
      position:absolute;right:8px;top:6px;border:0;border-radius:8px;
      font-weight:800;background:#fff7;backdrop-filter:blur(4px);cursor:pointer;
      padding:4px 7px;line-height:1
    }
    .note:hover{transform:rotate(var(--r, 0deg)) scale(1.01);transition:.12s}
    /* footer ctas */
    .cta-grid{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin-top:22px}
    @media (max-width:820px){.cta-grid{grid-template-columns:1fr}}
    .cta{background:#fff;border-radius:16px;padding:20px;text-align:center;
         box-shadow:0 12px 26px rgba(0,0,0,.08)}
    .cta h3{margin:0 0 10px}
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">

    <div class="toolbar">
      <a class="btn" href=".aboutus/index.html">‚Üê Back to Front Page</a>
      <a class="btn" href=".aboutus/faq.html">‚Üê Back to FAQ</a>
      <a class="btn" href=".aboutus/timeline.html#checkin">‚Üê Back to Timeline</a>
      <button id="btnResetAll" class="btn small" title="Hapus semua catatan (waspada!)">üóë Reset (delete all)</button>
    </div>

    <h1>Thank you so much for signing up, dear author!</h1>
    <div class="sub">Tinggalkan pesan semangat untuk author (anon boleh) üíå</div>

    <div class="row">
      <!-- form -->
      <div class="panel form">
        <input id="alias" maxlength="20" placeholder="Nama / anon" />
        <textarea id="message" maxlength="220" placeholder="Tulis semangatmu (maks 220 huruf)..."></textarea>
        <div class="actions">
          <button id="btnPost" class="btn dark">‚ú® Post</button>
          <span id="tip" class="muted" style="align-self:center"></span>
        </div>
      </div>

      <!-- board -->
      <div id="board" class="board" aria-live="polite"></div>
    </div>
      <div class="cta">
        <h3>AO3 Pages</h3>
        <a class="btn dark" href="https://archiveofourown.org/collections/WishfulThoughtsFest2025/works" target="_blank" rel="noopener">Open AO3 Works</a>
      </div>
    </div>
  </div>

  <!-- Supabase JS v2 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // ========= CONFIG =========
    const SUPABASE_URL = "https://daaazpzydtkustcblyee.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRhYWF6cHp5ZHRrdXN0Y2JseWVlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2NDI5MDQsImV4cCI6MjA3MjIxODkwNH0.WOuTidQd_IM5qu1yYUhuZSzhXTkKBk6cyBrXJY2TcHY";
    const COLORS = ["yellow","pink","blue","green"];
    const client = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // ========= DOM =========
    const board = document.getElementById('board');
    const aliasEl = document.getElementById('alias');
    const messageEl = document.getElementById('message');
    const btnPost = document.getElementById('btnPost');
    const btnResetAll = document.getElementById('btnResetAll');
    const tip = document.getElementById('tip');

    const tipMsg = (t)=>{ tip.textContent = t; clearTimeout(tip._t); tip._t=setTimeout(()=>tip.textContent="",3500); };

    function randColor(){ return COLORS[Math.floor(Math.random()*COLORS.length)]; }
    function randRotate(){ return (Math.random()*4-2).toFixed(2)+'deg'; }

    // ========= RENDER (GRID, no overlap) =========
    function renderNotes(rows){
      board.replaceChildren();
      rows.forEach(r=>{
        const n = document.createElement('div');
        n.className = `note ${r.color||'yellow'}`;
        n.style.setProperty('--r', randRotate());
        n.innerHTML = `${escapeHTML(r.message)}<small>‚Äî ${escapeHTML(r.alias||'anon')}</small>`;
        const x = document.createElement('button');
        x.className = 'x';
        x.textContent = '‚úï';
        x.title = 'Delete note';
        x.onclick = ()=> delOne(r.id);
        n.appendChild(x);
        board.appendChild(n);
      });
    }

    // ========= CRUD =========
    async function fetchNotes(){
      const { data, error } = await client
        .from('wall_notes')
        .select('id,alias,message,color,created_at')
        .order('created_at',{ascending:false})
        .limit(200);
      if(error){ console.error(error); tipMsg('Gagal memuat'); return; }
      renderNotes(data||[]);
    }

    async function postNote(){
      const alias = (aliasEl.value||'anon').trim().slice(0,20);
      const message = (messageEl.value||'').trim();
      if(!message){ tipMsg('Pesan masih kosong'); return; }
      if(message.length>220){ tipMsg('Maks 220 karakter'); return; }

      btnPost.disabled = true;
      const { error } = await client.from('wall_notes').insert({
        alias, message, color: randColor()
      });
      btnPost.disabled = false;

      if(error){ console.error(error); tipMsg('Gagal kirim'); return; }
      messageEl.value = '';
      tipMsg('Terkirim! ‚ú®');
      fetchNotes();
    }

    async function delOne(id){
      if(!confirm('Hapus catatan ini?')) return;
      const { error } = await client.from('wall_notes').delete().eq('id', id);
      if(error){ console.error(error); tipMsg('Gagal hapus'); return; }
      fetchNotes();
    }

    async function delAll(){
      if(!confirm('Hapus SEMUA catatan? (tak bisa undo)')) return;
      const { error } = await client.from('wall_notes').delete().neq('id', null);
      if(error){ console.error(error); tipMsg('Gagal reset'); return; }
      fetchNotes();
    }

    // ========= Utils =========
    function escapeHTML(s){ return String(s).replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[c])); }

    // ========= Bind =========
    btnPost.addEventListener('click', postNote);
    btnResetAll.addEventListener('click', delAll);

    // initial
    fetchNotes();
  </script>
</body>
</html>
