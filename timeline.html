<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wish Fic Fest — Timeline</title>
  <meta name="theme-color" content="#f3e7d4" />
  <meta name="description" content="Wish Fic Fest timeline in a playful snakes-and-ladders (ular tangga) board style." />
  <style>
    /* ===== Global: clean parchment ===== */
    :root{
      --parchment:#f3e7d4;       /* site-wide background */
      --ink:#222;                /* text */
      --sage:#6e8b72;            /* accent */
      --lace:#fff;               /* cards */
      --stitch:#e8d9bf;          /* stitch/dash */
      --gold:#c99a2e;            /* headings */
    }
    html,body{margin:0; background:var(--parchment); color:var(--ink); font-family:"Iowan Old Style", Garamond, Georgia, ui-serif, serif}
    *,*::before,*::after{ box-sizing:border-box }
    ul,ol{list-style:none;margin:0;padding:0}

    .wrap{ max-width:1100px; margin:auto; padding:20px }
    h1{ margin:8px 0 14px; font-size:clamp(28px,6vw,54px); font-weight:700; font-variant:small-caps; letter-spacing:.5px }

    /* ===== Board ===== */
    .board{
      position:relative;
      aspect-ratio: 4 / 3;
      background: var(--parchment);
      border-radius:24px;
      box-shadow: 0 12px 28px rgba(0,0,0,.06);
      border: 2px dashed var(--stitch);
      overflow:hidden;
    }

    svg.path{ position:absolute; inset:0; }
    .stitch{ stroke:#7a6b5a; stroke-width:6; stroke-dasharray:2 14; fill:none; opacity:.8; filter:drop-shadow(0 2px 0 rgba(0,0,0,.06)); }

    .milestone{
      background:var(--lace);
      border-radius:18px;
      border:2px dashed var(--stitch);
      box-shadow:0 10px 22px rgba(0,0,0,.08);
      padding:12px 14px;
      text-align:left;
      display:flex; flex-direction:column; justify-content:center;
    }
    .milestone h3{ margin:0; color:var(--gold); font-size:clamp(18px,2.4vw,26px) }
    .milestone .date{ opacity:.9; font-weight:700; margin-top:6px }
    .milestone small{ opacity:.85 }

    .token{ position:absolute; width:26px; height:26px; border-radius:50%; background:linear-gradient(#6e8b72,#56715d); box-shadow:0 6px 14px rgba(0,0,0,.18); border:2px solid #fff }

    .toolbar{ display:flex; gap:10px; align-items:center; margin-top:10px }
    .btn{ display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border:1px solid #d8c9ad; border-radius:12px; background:#fff; color:#222; text-decoration:none; font-weight:700 }
    .btn:hover{ background:#f8f1e3 }

    /* Status boxes */
    .statusGrid{ display:flex; gap:12px; flex-wrap:wrap; margin:6px 0 14px }
    .smallcard{ background:#fff; border:2px dashed var(--stitch); border-radius:14px; padding:10px 12px; box-shadow:0 8px 16px rgba(0,0,0,.06) }
    .smalltitle{ font-weight:800; font-size:13px; color:#6d5f4f; text-transform:uppercase; letter-spacing:.4px }
    .big{ font-weight:900; font-size:clamp(18px,4.5vw,28px); color:var(--gold) }
    .small{ font-size:13px; opacity:.85 }
    .smallcard.ok{ border-color:#d8e9df }
    .smallcard.warn{ border-color:#f7d7b8 }
    .smallcard.due{ border-color:#f2b8b8 }

    /* Absolute positions */
    .milestone{ position:absolute; transform:translate(-50%,-50%); min-width:220px; max-width:360px; }
    .btnmini{ display:inline-block; margin-top:8px; padding:8px 12px; border-radius:999px; background:var(--sage); color:#fff; text-decoration:none; font-weight:800; box-shadow:0 6px 14px rgba(0,0,0,.12) }
    .btnmini:hover{ filter:brightness(.95) }

    /* Existing milestones */
    .ms-prompt{ left:18%; top:86% }
    .ms-claim{  left:68%; top:66% }
    .ms-sign{   left:32%; top:56% }
    .ms-check{  left:68%; top:40% }
    .ms-submit{ left:84%; top:18%; z-index:3 }

    /* NEW: Posting + Masterlist cards */
    .ms-post { left:54%; top:15%; z-index:4 }   /* just under Submission card on the path */
    .ms-master{ left:20%; top:12%; z-index:5 }   /* very top end */

    /* === Mobile tidy: stack cards === */
    @media (max-width:860px){
      .board{ display:flex !important; flex-direction:column; gap:12px; aspect-ratio:auto !important; padding:16px 16px 24px !important }
      svg.path, .token{ display:none !important }
      .milestone{ position:relative !important; left:auto !important; top:auto !important; transform:none !important; width:100% !important; max-width:none !important; margin:0 !important; padding:14px 16px 14px 36px !important }
      .board .milestone + .milestone{ margin-top:12px !important }
      .board::after{ content:""; position:absolute; left:18px; top:0; bottom:0; border-left:6px dotted #7a6b5a; opacity:.55 }
      .milestone::before{ content:""; position:absolute; left:12px; top:22px; width:14px; height:14px; border-radius:50%; background:linear-gradient(#6e8b72,#4f6b57); border:2px solid #fff; box-shadow:0 4px 10px rgba(0,0,0,.18) }
      /* order top→bottom story */
      .ms-submit{ order:1 }     /* Submission window (Sep 15–Oct 12) */
      .ms-post{ order:2 }       /* Posting + Author reveals (Sep 29) */
      .ms-check{ order:3 }
      .ms-sign{ order:4 }
      .ms-claim{ order:5 }
      .ms-prompt{ order:6 }
      .ms-master{ order:7 }     /* Masterlist (Oct 12) */
    }
  
    /* Preview grid (toggle) */
    .previewGrid{position:absolute; inset:0; pointer-events:none; display:none; background-image:
      linear-gradient(to right, rgba(0,0,0,.06) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(0,0,0,.06) 1px, transparent 1px);
      background-size: 5% 100%, 100% 5%;
      border-radius:24px;
    }
    .board.preview .previewGrid{ display:block }
        </style>
</head>
<body>
  <div class="wrap">
    <h1>Timeline</h1>

    <!-- STATUS BOXES -->
    <div class="statusGrid" aria-label="Timeline status">
      <div class="smallcard" id="nowBox">
        <div class="smalltitle">Where we are now</div>
        <div class="big" id="nowPhase">—</div>
        <div class="small" id="nowDetail"></div>
      </div>
      <div class="smallcard" id="countBox">
        <div class="smalltitle">Countdown to Masterlist (Oct 12)</div>
        <div class="big" id="hCount">—</div>
        <div class="small" id="countDetail"></div>
      </div>
    </div>

    <section class="board" aria-label="Ular tangga style board">
      <div class="previewGrid" aria-hidden="true"></div>
      <svg class="path" viewBox="0 0 1000 750" preserveAspectRatio="none" aria-hidden="true">
        <path class="stitch"
          d="M 60,710
             Q 260,710 380,630
             T 700,630
             Q 900,630 940,520
             Q 860,440 680,440
             Q 480,440 300,360
             Q 420,280 620,280
             Q 840,280 940,190
             Q 820,120 620,120
             Q 420,120 100,50" />
      </svg>

      <!-- Bottom → Top milestones -->
      <article class="milestone ms-prompt">
        <h3>Prompting</h3>
        <div class="date">Aug 15 – Aug 25</div>
        <small>Submit your ideas; prompts go public.</small>
        <a class="btnmini" href="https://bit.ly/PromptingWFF" target="_blank" rel="noopener">Submit a Prompt</a>
      </article>

      <article class="milestone ms-claim">
        <h3>Claiming Begins</h3>
        <div class="date">Aug 17</div>
        <small>First come, first served.</small>
        <a class="btnmini" href="https://archiveofourown.org/collections/WishfulThoughtsFest2025/requests" target="_blank" rel="noopener">Claim a Prompt</a>
      </article>

      <article class="milestone ms-sign">
        <h3>Author Sign-ups</h3>
        <div class="date">Aug 17 – Sep 13</div>
        <small>Self-prompt or pick a public prompt.</small>
        <a class="btnmini" href="https://docs.google.com/forms/d/e/1FAIpQLSfNE60WbBfBOb2pQBFw__6Vmt7zW1-WS3EyucP5gDqQ09-alw/viewform" target="_blank" rel="noopener">Author Sign-up Form</a>
      </article>

      <article class="milestone ms-check">
        <h3>Check-In</h3>
        <div class="date">Sep 1</div>
        <small>Quick status update to mods.</small>
      </article>

      <article class="milestone ms-submit">
        <h3>Submission Period</h3>
        <div class="date">Sep 15 – Oct 12</div>
        <small>Post to AO3 under the WishFicFest collection.</small>
        <a class="btnmini" href="https://archiveofourown.org/collections/WishfulThoughtsFest2025/works" target="_blank" rel="noopener">
          Post to AO3
        </a>
      </article>

      <!-- NEW: Posting + Author Reveals -->
      <article class="milestone ms-post">
        <h3>Posting & Author Reveals</h3>
        <div class="date">Sep 29</div>
        <small>Posting will end on Sep 29. Author reveals are posted on Sep 29.</small>
      </article>

      <!-- NEW: Masterlist -->
      <article class="milestone ms-master">
        <h3>Masterlist Thread</h3>
        <div class="date">Oct 12</div>
        <small>Final thread to collect all works.</small>
      </article>

      <!-- fun tokens -->
      <span class="token" style="left:12%; top:88%"></span>
      <span class="token" style="left:46%; top:72%"></span>
      <span class="token" style="left:62%; top:57%"></span>
      <span class="token" style="left:28%; top:46%"></span>
      <span class="token" style="left:56%; top:34%"></span>
      <span class="token" style="left:86%; top:20%"></span>
    </section>

    <div class="toolbar">
      <button class="btn" id="btnPreview">Toggle Preview Grid</button>
      <a class="btn" href="index.html">← Back to Front Page</a>
      <a class="btn" href="#" id="btnAddCal">Add Dates to Calendar (.ics)</a>
    </div>
  </div>

  <script>
    // ===== Calendar export =====
    const events = [
      { title:'Prompting', start:'2025-08-15', end:'2025-08-25', description:'Wish Fic Fest prompting window.' },
      { title:'Claiming Begins', start:'2025-08-17', end:'2025-08-17', description:'Prompt claiming opens.' },
      { title:'Author Sign-ups', start:'2025-08-17', end:'2025-09-13', description:'Sign-ups for authors.' },
      { title:'Check-In', start:'2025-09-01', end:'2025-09-01', description:'Author check-in.' },
      { title:'Submission Period', start:'2025-09-15', end:'2025-10-12', description:'Post to AO3 under WishFicFest.' },
      { title:'Posting & Author Reveals', start:'2025-09-29', end:'2025-09-29', description:'Posting ends; author reveals posted.' },
      { title:'Masterlist Thread', start:'2025-10-12', end:'2025-10-12', description:'Final thread to collect all works.' }
    ];
    function toICSDate(d){ return d.replace(/-/g,'') + 'T000000Z'; }
    function buildICS(){
      const lines=['BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//Wish Fic Fest//Timeline//EN'];
      events.forEach(e=>{
        lines.push('BEGIN:VEVENT');
        lines.push('DTSTART:' + toICSDate(e.start));
        lines.push('DTEND:' + toICSDate(e.end));
        lines.push('SUMMARY:' + e.title);
        lines.push('DESCRIPTION:' + e.description);
        lines.push('END:VEVENT');
      });
      lines.push('END:VCALENDAR');
      return lines.join('\\r\\n');
    }
    document.getElementById('btnAddCal').addEventListener('click', ()=>{
      const blob = new Blob([buildICS()], {type:'text/calendar'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'wishficfest-timeline.ics';
      a.click();
      URL.revokeObjectURL(url);
    });
  </script>

  <script>
    // ===== Live status + countdown =====
    (function(start){
      if (document.readyState !== 'loading') start();
      else {
        document.addEventListener('DOMContentLoaded', start, {once:true});
        window.addEventListener('load', start, {once:true});
      }
    })(function(){
      const D = (y,m,d)=> new Date(y, m-1, d);
      const today = new Date();
      const dates = {
        prompting: {start: D(2025,8,15), end: D(2025,8,25)},
        claimOpen: D(2025,8,17),
        signups:   {start: D(2025,8,17), end: D(2025,9,13)},
        checkin:   {start: D(2025,9,1),  end: D(2025,9,1)},
        submission:{start: D(2025,9,15), end: D(2025,10,12)},
        posting:   {start: D(2025,9,29), end: D(2025,9,29)},
        master:    {start: D(2025,10,12), end: D(2025,10,12)}
      };
      const endOfDay = d=>{ const x=new Date(d); x.setHours(23,59,59,999); return x; };
      const inRange = (t, r)=> t>=r.start && t<=endOfDay(r.end);

      function currentPhase(t){
        if(inRange(t, dates.posting))   return {k:'posting',    title:'Posting & Author Reveals', detail:'Ends Sep 29 — reveals today.'};
        if(inRange(t, dates.submission))return {k:'submission', title:'Submission Period',        detail:'Posting to AO3 is open.'};
        if(inRange(t, dates.checkin))   return {k:'checkin',    title:'Check-In',                 detail:'Send a quick status to mods.'};
        if(inRange(t, dates.signups))   return {k:'signups',    title:'Author Sign-ups & Claiming', detail:'Self-prompt or claim a prompt.'};
        if(t>=dates.claimOpen && t<dates.signups.start) return {k:'claim', title:'Claiming Begins', detail:'Claims are open.'};
        if(inRange(t, dates.prompting)) return {k:'prompting',  title:'Prompting',                detail:'Submit your ideas.'};
        if(t < dates.prompting.start)   return {k:'prefest',    title:'Pre-fest',                 detail:'Prompting opens Aug 15.'};
        return {k:'closed', title:'Closed', detail:'Round finished — thank you!'};
      }

      const now = currentPhase(today);
      document.getElementById('nowPhase').textContent = now.title;
      document.getElementById('nowDetail').textContent = now.detail;
      const nowBox = document.getElementById('nowBox');
      nowBox.classList.add(now.k==='submission'?'ok':now.k==='prefest'?'warn':'');

      // Countdown to submission deadline (Oct 12, 23:59)
      const deadline = new Date(2025,9,12,23,59,59,999);
      function updateCountdown(){
        const diffMs = deadline - new Date();
        const day=86400000, hour=3600000, minute=60000, second=1000;
        const hCount = document.getElementById('hCount');
        const detail = document.getElementById('countDetail');
        const box = document.getElementById('countBox');
        if (diffMs >= 0){
          const days = Math.floor(diffMs / day);
          const hours = Math.floor((diffMs % day) / hour);
          const minutes = Math.floor((diffMs % hour) / minute);
          const seconds = Math.floor((diffMs % minute) / second);
          const pad=n=>n<10?('0'+n):String(n);
          hCount.textContent = `${days}d ${pad(hours)}:${pad(minutes)}:${pad(seconds)}`;
          detail.textContent = `until Oct 12, 23:59`;
          box.classList.remove('due','warn','ok');
          if(days <= 3) box.classList.add('due');
          else if(days <= 10) box.classList.add('warn');
          else box.classList.add('ok');
        } else {
          hCount.textContent = 'Closed';
          detail.textContent = 'Submission window ended (Oct 12).';
          box.classList.add('due');
        }
      }
      updateCountdown();
      setInterval(updateCountdown, 1000);
      document.getElementById("btnPreview").addEventListener("click", ()=>{
        document.querySelector(".board").classList.toggle("preview");
      });
    });
  </script>
</body>
</html>
